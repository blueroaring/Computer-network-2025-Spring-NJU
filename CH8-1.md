# CH8-1

![](/Images/2e8ab779-8d75-4c8c-b34b-34ea021cd995.png)

![](/Images/09e9b1e6-f8f8-4d9b-a097-e00fd5cc7e02.png)

### 被动攻击

- 窃听传输内容
  - 泄露消息内容
- 流量分析
  - 通过监控主机对之间消息的频率和长度
  - 可能推测出通信的性质
- 难以检测，但可以预防

### 主动攻击

- 伪装
  - 假扮成不同的实体
- 重放
  - 拦截并捕获，然后重新传输
- 修改消息内容
- 拒绝服务
- 难以预防，但可以检测

### 安全需求

- 可用性（针对中断）
  - 确保资源可访问
- 保密性（针对拦截）
  - 仅发送方和预期接收方能够理解消息内容
- 完整性（针对篡改）
  - 确保消息在传输等过程中未被篡改且可被检测
- 真实性（针对伪造）
  - 发送方和接收方确认彼此身份及数据来源

![](/Images/b0c293fb-1666-4ea4-a1e9-c832850b939a.png)

### 处理网络安全

- 加密：使消息无法被理解
- 消息认证码（MAC）：确保消息无法被篡改
- 签名：确保来源无法被伪造 / 捏造

![](/Images/07d4d4c3-a8ef-43c0-abb0-7d6550b7ac51.png)

![](/Images/763460b5-2396-465a-ae3e-004ead7006f0.png)

- 对称密钥加密：发送方和接收方的密钥相同
- 公钥加密：加密密钥是公开的，解密密钥是保密的

![](/Images/cc9e1aad-0c51-447e-941f-1cf625e94555.png)

### 成分

- 明文
- 加密算法
- 密钥
- 密文
- 解密算法

### 加密要求

- 强大的加密算法
  - 即使算法已知且有若干 “密文 - 明文” 对可用
  - 也不应能解密或推导出密钥
- 发送方和接收方必须安全获取密钥 —— 密钥分发
  - 一旦密钥泄露，所有使用该密钥的通信内容都会被读取

### 攻击加密

- 仅密文攻击：特鲁迪（Trudy）拥有可分析的密文
- 两种方法：
  - 暴力破解：遍历所有可能的密钥
  - 密码分析：
    - 依赖算法特性及明文 / 密文的一般特征知识
    - 尝试推导明文或密钥
- 已知明文攻击：特鲁迪拥有与密文对应的明文
- 选择明文攻击：特鲁迪可获取选定明文对应的密文

### 传统加密技术

- 替代法
  - 字母表中的字母被替换为其他字母 / 数字 / 符号
  - 凯撒密码
  - 单表密码
  - 维吉尼亚密码
- 置换（排列）法
  - 重新排列（打乱）输入内容，不改变实际使用的字母
  - 栅栏密码
  - 行列密码

![](/Images/a580c0e3-3aa2-46f1-ab4f-2d07c6016c4b.png)

![](/Images/08a9a6d2-9c25-4ee3-a86a-f84ab0e1c95d.png)

![](/Images/c205df27-9296-4ceb-a32d-30271e5130ce.png)

![](/Images/452fdd5f-cb82-45e7-89d5-4e9b006e5f60.png)

![](/Images/4aa7746f-a082-4e50-955c-5171feab71a8.png)

![](/Images/6b4c429f-42d3-4097-a334-5439dd5340e7.png)

![](/Images/fd69c433-d7d0-4201-837b-6bb7921465fe.png)

![](/Images/cb99f69e-4c9e-4376-8a1a-2901d424aab6.png)

![](/Images/9461809a-90d6-4c26-8dac-2758dac32822.png)

### 现代加密算法

- 分组密码
  - 以固定块大小处理明文
  - 生成等大的密文块
- 常用算法
  - 数据加密标准（DES）
  - 三重 DES（TDES）
  - 高级加密标准（AES）

![](/Images/ff427242-5aa5-4601-993f-4cbffffe7bed.png)

### Feistel 密码

- 一种用于指定分组密码算法的方案 / 模板
- 允许使用相同的硬件电路 / 软件实现加密和解密
- 输入块 Mi 被拆分为半块 Li 和 Ri
- 对于下一轮：
- Li+1 = Ri
- Ri+1 = f(Ri, Ki) ⊕ Li

![](/Images/5a659423-18a3-4558-a70c-30121047bf09.png)

### DES 结构

- 块大小 ——64 位
- 密钥大小 ——56 位（存储在 64 位缓冲区中）
- 对输入块（64 位）进行固定初始置换
- 从密钥（56 位）派生 16 轮子密钥（48 位）
- 16 轮子密钥的密钥调度方案
- 16 次迭代，每次迭代均使用轮密钥（48 位）对轮块（64 位）进行置乱
- 对输出块进行固定逆初始置换

![](/Images/05ff4dc2-9a4d-418d-8c00-c7d2df8d9393.png)

![](/Images/f10f0910-eb7e-4d16-b6af-fc4316ae236a.png)

### 攻击 DES

- 穷举搜索攻击
  - 搜索空间为 O (2⁵⁶)=O (10¹⁷) 个密钥
  - 不存在 “后门”
- DES 如今已无安全性可言
  - 20 世纪 70 年代，迪菲（Diffie）和赫尔曼（Hellman）提出，一台价值 2000 万美元的机器可在约一天内破解 DES
  - 20 世纪 90 年代，维纳（Wiener）提出，一台价值 100 万美元的机器可在 3.5 小时内破解 DES
  - 20 世纪 90 年代，通过分布式计算机集群，DES 挑战赛可在数日内被攻破
  - 据推测，大多数国家安全机构具备在数小时内破解 DES 的硬件和软件

### AES 参数

- B：以 32 位字为单位的分组大小，4 表示 128 位
- K：以 32 位字为单位的密钥大小，4/6/8（即 128/192/256 位）
- r：轮数 ——6 + max (B, K)
  - AES-128——10 轮
  - AES-192——12 轮
  - AES-256——14 轮

### AES 描述

- 状态数组
  - 一个 4 行 × B（=4）列的矩形数组
  - 数组中的每个元素存储一个字节（8 位）
  - 状态数组的初始值为按列输入的明文块
  - 状态在 r 轮变换中被转换
  - 状态的最终值为按列读取的密文块
- 密钥扩展方案
  - 密钥被组织为一系列密钥组
  - 初始密钥组由 K 列组成，每列 4 个字节（32 位）
  - 密钥扩展生成 (r+1)×B 个 4 字节列

### 每轮 AES（1）

- 4×B 字节输入
- 将输入放入状态数组中
- 4×K 字节密钥
- 密钥扩展
- 输入与 K0 进行异或运算
- 对状态数组进行 r 轮变换并与 Ki 进行异或运算

![](/Images/260bef9b-47c4-4f77-9774-ef2188a3a1d5.png)

### 每轮 AES（2）

- 每轮包含 4 种基本操作
  - S 盒（字节替换）：通过查表实现字节到字节的替换
  - 行移位：按一定单元数对行进行循环移位来重新排列字节
  - 列混淆：使用查表操作，将 4 字节列替换为另一组 4 字节列
  - 与当前轮密钥进行按位异或运算

### 行移位

- 4×B 个单元，每个单元 8 位
  - 状态数组的第 0 行不进行移位
  - 状态数组的第 1 行向左循环移位 1 列
  - 状态数组的第 2 行向左循环移位 2 列
  - 状态数组的第 3 行向左循环移位 3 列

![](/Images/3b3a908b-5788-48cc-82f0-e7a0b15b8656.png)

### 列混淆操作

- 针对每个 4 字节列
  - 计算生成一个新的 4 字节列

![](/Images/7578d02f-ef38-4130-9532-6a0e5157d9a1.png)

![](/Images/8552967e-b47c-485f-91b1-672eb56b368f.png)

### AES 描述

- 结构简单
  - 加密和解密过程均以 “轮密钥加” 阶段开始
  - 随后进行 r–1 轮变换，每轮包含全部 4 种操作
  - 最后一轮包含 3 种操作
- “轮密钥加” 操作加上 3 种比特置乱操作
- 解密时按逆序使用扩展密钥
  - 解密算法与加密算法并不相同

![](/Images/61bbef1b-d289-414b-ba3b-105091fea934.png)

### 公钥密码学

- 一种完全不同的方法
  - 基于数学算法
- 非对称密钥
  - 使用两个独立的密钥
  - 发送方和接收方不共享对称秘密密钥
- 每个终端系统拥有
  - 一个公开的加密密钥（所有人都知道）
  - 一个私有的解密密钥（仅所有者知晓）

![](/Images/2f01ed7d-8c2c-4a04-9433-415b066900a5.png)

### 公钥模型

- 实体 A 拥有两个密钥

  - PRVA——A 的私钥，仅由 A 秘密保存

  - PUBA——A 的公钥，向所有人公开

- 存在两种函数
  - 加密 —— 使用两个密钥中的一个
  - 解密 —— 使用另一个密钥
- 满足以下条件
  - Decrypt(Encrypt(M, PUBA), PRVA) = M
  - Decrypt(Encrypt(M, PRVA), PUBA) = M

### 公钥要求

- 加密和解密函数的算法应当是已知的
- 在已知公钥和算法的情况下，应当难以找到私钥
- 在已知使用公钥加密的密文时，应当难以获取明文
- 在已知公钥及对应的（明文，密文）对时，应当难以找到私钥

### 前提条件：模运算

-  x mod n 表示 x 除以 n 的余数
- 性质：
  - [(a mod n) + (b mod n)] mod n = (a+b) mod n
  - [(a mod n) - (b mod n)] mod n = (a-b) mod n
  - [(a mod n) × (b mod n)] mod n = (a×b) mod n
- 因此
  - (a mod n)ᵈ mod n = aᵈ mod n
- 示例：x=14，n=10，d=2
  - (x mod n)ᵈ mod n = 4² mod 10 = 6
  - xᵈ = 14² = 196，xᵈ mod 10 = 6

### RSA：准备工作

- 消息：仅为位模式
  - 位模式可由一个整数唯一表示
- 因此，加密消息等同于加密一个数字

- 示例：
  - m = 10010001，该消息可由十进制数 145 唯一表示。
  - 要加密 m，需加密对应的数字，从而得到一个新数字（即密文）。

![](/Images/d9c236ea-90fd-4bd1-8cb1-12471ec26b43.png)

![](/Images/1385e7a7-b7b6-4f49-a5aa-37f785b5040b.png)

### RSA 加密与解密

- 欧拉定理
  - (Mᵉ mod N)ᵈ mod N = Mᵉᵈ mod N = M(mod N)
- 加密
  - 使用公钥（e, N）对消息块 M<N 进行加密
  - C = Mᵉ (mod N)
  - 仅发送 C
- 解密
  - 使用私钥（d, N）对密文 C<N 进行解密
  - M = Cᵈ (mod N)

![](/Images/87d66da2-0485-403d-b0fb-9f78040a368e.png)

![](/Images/aaa37d21-19f7-43be-8a54-0e633e719642.png)

![](/Images/8db21874-e694-4616-b4c7-de87a43c38b6.png)

### 关于 RSA 的更多内容

- 反向情况
  - (Mᵈ mod N)ᵉ mod N = Mᵈᵉ mod N = M(mod N)
- 签名
  - A 使用私钥（d, N）对消息块 M<N 进行签名
  - S = Mᵈ (mod N)
  - 发送 M 和 S
- 验证
  - B（及其他人）使用公钥（e, N）验证消息 M 的签名 S
  - Sᵉ = M (mod N)
  - 这可验证 A 的身份，因为只有 A 拥有私钥

### RSA 在实际应用中：会话密钥

- RSA 中的指数运算计算量极大
- DES 的速度至少比 RSA 快 100 倍
- 使用公钥密码学建立安全连接，然后生成第二个密钥 —— 对称会话密钥 —— 用于加密数据

会话密钥 KS

- 鲍勃和爱丽丝使用 RSA 交换对称密钥 KS
- 一旦双方都拥有 KS，就使用对称密钥密码学进行通信

## 总结

- 对称密钥密码学
- 传统方法
  - 替换法
    - 凯撒密码
    - 单表代换密码
    - 维吉尼亚密码
  - 置换（排列）法
    - 栅栏密码
    - 行列置换密码
- 现代方法：分组密码
  - 数据加密标准（DES）
  - 三重 DES（TDES）
  - 高级加密标准（AES）
- 非对称密钥密码学：RSA
