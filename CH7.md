# CH7

## 无线和移动网络

- 近年来极为流行
- 移动用户数量现已超过有线电话用户（比例超过 5:1）
- 面临两大重要挑战
  - 无线：通过无线链路进行通信
  - 移动性：处理改变网络接入点的移动用户
    - 非无线网络可能也需要处理移动性问题
    - 切换：移动用户更换为其提供有线网络连接的基站

![](/Images/058328d2-6ddd-4cf0-bccf-d1a856b30603.png)

![](/Images/df4f904b-abe1-419d-9684-7ea692bf538a.png)

![](/Images/6de944a3-aeec-433e-9c2d-cc2bfd2eee06.png)

![](/Images/89de3c48-841a-4398-a40b-e6c2200e0440.png)

### 两种工作模式

- 基础设施模式：基站将移动设备连接至有线网络
- 自组织模式：无线主机自行组织通信

![](/Images/aa82a951-46e6-44f1-8126-4b25dadfa4c4.png)

![](/Images/b0f820aa-ba24-4d83-bfdd-bb7714a2541f.png)

### 自组织网络

- 点对点通信，无需基站
- 节点自行组织成网络：在彼此之间进行路由

### 无线网络分类

![](/Images/e68624dc-f280-4a13-9b72-f5160d184cba.png)

### 无线链路特性

 与有线链路存在三个重要区别
（1）信号强度衰减：无线电信号在穿过物质时会衰减（路径损耗）

### 路径损耗 / 路径衰减

-  自由空间路径损耗（FSPL）：
- FSPL = （4πdf/c）²
-  d = 距离
-  λ = 波长（c/f）
-  f = 频率
-  c = 光速
-  产生原因：
  -  反射、衍射、吸收、地形轮廓（城市、乡村、植被）、湿度

### 信噪比和误码率

- SNR：信噪比
  - 信噪比越高，越容易从噪声中提取信号（有利）
- BER：误码率
- 信噪比与误码率的权衡关系
- 对于给定物理层：
  - 提高功率→提高信噪比→降低误码率
- 对于给定信噪比：
  - 选择满足误码率要求且能提供最高吞吐量的物理层
- 信噪比可能随移动性变化：需动态适配物理层

(2）多径传播：无线电信号从地面物体反射，以略有不同的时间到达目的地

### 多径效应

- 信号从表面反射并相互干扰
- 自干扰

![](/Images/60b83a79-2f23-43de-892f-bf2def9c959a.png)

（3）来自其他源的干扰：标准化无线网络频率（如 2.4 GHz）会被其他设备（如电话）共享；设备（电机）也会产生干扰

无线网络特性

- 广播介质
  - 附近的任何设备都能接收到信号并产生干扰
- 传输时无法接收信号
  - 自身（或附近）的传输会对接收器造成强干扰→半双工模式
  - 近期研究表明全双工模式也可能实现
- 发送方发出的信号并非总能完整到达接收方
- 多个无线发送方和接收方会引发诸多问题
  - 多路访问问题（我们此前已了解）
  - 隐藏终端问题

---

## WiFi - IEEE 802.11 Wireless LANs

![](/Images/d1262812-e1fa-4110-9bcf-0bc3e9fa9b14.png)

![](/Images/390aaa19-590e-4c76-8af0-08f3d0c7944a.png)

### IEEE 802.11 架构

- 工作站（Station）：具备符合 IEEE 802.11 标准的 MAC 层和物理层的设备

- 接入点（Access Point, AP）：
  - 通过无线介质为分布式系统提供接入能力

- 基本服务集（Basic Service Set, BSS）：
  - 由一个接入点（基站）协调的单一小区

- 扩展服务集（Extended Service Set, ESS）：

  - 由分布式系统（Distribution System, DS）互联的多个 BSS

  - DS 可以是交换机、有线网络或无线网络

  - ESS 在逻辑上呈现为单一局域网

  - 网关（路由器）提供互联网接入

- 分布式系统（Distribution System, DS）：
  - 用于互联一组 BSS 和集成局域网以形成 ESS 的系统

![](/Images/1d884e72-12f8-4172-99dd-352710106765.png)

### 802.11：信道与关联

- 802.11b：2.4GHz-2.485GHz 频段按不同频率划分为 11 个信道
  - 接入点（AP）管理员为 AP 选择频率
  - 可能产生干扰：信道可能与相邻 AP 选择的信道相同！
- 主机：必须与某个 AP 关联
  - 扫描信道，监听包含 AP 名称（SSID）和 MAC 地址的信标帧
  - 选择要关联的 AP
  - 可能执行身份验证
  - 通常会运行 DHCP 以获取 AP 所在子网的 IP 地址

### 扫描关联

- 被动扫描：
  - 接入点（AP）发送信标帧
  - 发送关联请求帧：H1 向选定的 AP 发送
  - 发送关联响应帧：选定的 AP 向 H1 发送

- 主动扫描：
  - H1 广播探测请求帧
  - 接入点（AP）发送探测响应帧
  - 发送关联请求帧：H1 向选定的 AP 发送
  - 发送关联响应帧：选定的 AP 向 H1 发送

![](/Images/93fa9d5a-589b-4aaa-ad1b-dc6968e09635.png)

### IEEE 802.11：多路访问

- 多个无线发送方和接收方会引发额外问题（超出多路访问范畴）

- 隐藏终端问题
  - B 和 A 可以相互通信
  - B 和 C 可以相互通信
  - A 和 C 无法相互通信
  - A 和 C 意识不到它们在 B 处产生的干扰

- 暴露终端问题
  - S1 和 S2 可以相互通信
  - S2 在听到 S1 传输时会等待
  - 但 S1→R1 和 S2→R2 可以同时传输，因为它们不存在空间干扰

- 信号衰减问题
  - B 和 A 可以相互通信
  - B 和 C 可以相互通信
  - A 和 C 无法相互通信，却在 B 处产生干扰

![](/Images/e0ab9f8b-72bc-4439-a266-c414c1851bfa.png)

### 4 帧交换

- 通过使用 RTS/CTS 解决隐藏终端问题
- 为增强无线通信可靠性，可采用 4 帧交换机制
  - 发送方向接收方发送请求发送（RTS）帧
  - 接收方回复允许发送（CTS）帧
  - 发送方收到 CTS 后传输数据帧
  - 接收方回复确认（ACK）帧
- 其他站点暂停传输以避免冲突
  - RTS 帧会通知所有处于发送方覆盖范围内的站点当前正在进行数据交换
  - CTS 帧会通知所有处于接收方覆盖范围内的站点
- RTS/CTS 交换是一项必备功能，但也可禁用

![](/Images/2c3cc1da-3a70-428f-b4fc-8ba6f8f73ed6.png)

![](/Images/88d152b0-1ef0-48fe-963d-93061810123d.png)

![](/Images/a9ec04a9-65ec-4265-b19d-1216a1cf7bc8.png)

---

### 三级优先级

- 短帧间间隔（SIFS）
  - 最短的帧间间隔 —— 优先级最高
  - 用于所有即时响应

- 点协调功能帧间间隔（PIFS）
  - 中等长度的帧间间隔
  - 点协调功能（PCF）机制中，中央控制器发送轮询时使用

- 分布式协调功能帧间间隔（DIFS）
  - 最长的帧间间隔
  - 用于其他竞争接入的异步帧

![](/Images/59f3f865-b61d-4f00-8ed8-cd9a0ad1b0a0.png)

### SIFS 的使用

- 确认帧（ACK）
  - 站点在等待 SIFS 间隔后发送 ACK 响应
- 多帧 LLC PDU 的传输
  - 需传输多帧 LLC PDU 的站点使用常规帧间间隔（IFS）发送首个 MAC 帧
  - 后续每帧均在 SIFS 间隔后发送
- 轮询响应
  - 轮询后的响应帧
- 允许发送（CTS）
  - 站点可通过使用常规 IFS 发送 RTS 帧来确保数据帧能成功传输
  - 目标站点若准备好接收，应使用 SIFS 间隔回复 CTS 帧

### PIFS 和 DIFS

- 集中控制器使用 PIFS
  - 用于发送轮询
  - 优先级高于普通竞争流量
  - 使用 SIFS 的帧优先级高于 PCF 轮询
- DIFS 用于所有普通异步流量

![](/Images/f52da2ec-82d2-4aca-b249-4f189cd9237a.png)

### 点协调功能（PCF）

- 由集中式轮询主控器（点协调器）执行轮询
  - 发送轮询时使用 PIFS（<DIFS）
  - 在发送轮询和接收响应期间，可抢占介质并阻止所有异步流量
- 配置为处理多个有时效性流量站点的无线网络，由点协调器控制
  - 点协调器以轮询方式向配置了轮询功能的站点发送轮询
  - 发送轮询后，被轮询站点可使用 SIFS 进行响应
  - 若点协调器收到响应，会使用 PIFS 发送下一个轮询
  - 若在预期响应时间内未收到响应，协调器会发送下一个轮询
  - 重复此过程直至当前轮询周期结束

### 超级帧:

点协调器不断发布轮询,会封锁所有异步通信量。为了避免这种情况,在超
帧时间的前一部分,由点协调器轮询,在超帧时间的后一部分,允许异步通
信量争用接入。

![](/Images/204f395d-152c-4dda-a1bf-b28330a97b17.png)

### 分布式协调功能

- DCF 子层采用 CSMA/CA（载波侦听多路访问 / 冲突避免）机制
  - 站点在传输前会感知信道状态
  - 避免与其他站点正在进行的传输发生冲突
- DCF 包含延迟机制
  - 帧间间隔（IFS）：站点在传输前需等待 IFS 时间
  - 体现优先级方案
- 不支持冲突检测，原因如下：
  - 由于信号衰减（衰落），传输时难以接收（感知冲突）
  - 发送站点无法区分弱输入信号与噪声，也无法区分自身传输的影响
  - 无论如何都无法感知所有冲突：隐藏终端、信号衰落等问题
  - 成功传输依赖 ACK 确认帧

### IEEE 802.11 MAC 协议：CSMA/CA

802.11 发送方

1. 若检测到信道空闲时间达到 DIFS，则发送方传输整个帧（无冲突检测）
2. 若检测到信道繁忙，则：
   - 等待 DIFS
   - 启动随机退避计时器
   - 信道空闲时计时器倒计时
   - 计时器到期后传输
   - 若未收到 ACK，增大随机退避间隔，重复步骤 2

802.11 接收方

- 若正确接收帧
  - 等待 SIFS 后返回 ACK（因隐藏终端问题需 ACK 确认）

![](/Images/0cfe95d1-cba0-4b98-a40d-f7a327f07f2d.png)

![](/Images/5b9a7ca1-307e-4a0c-bd87-4475a005ce06.png)

![](/Images/73129ac2-5a78-45c0-a3d6-9758878fdd06.png)

![](/Images/bcb80584-5250-4457-8a35-e41d86d80ce2.png)

### 802.11：同一子网内的移动性

- H1 仍处于同一 IP 子网：IP 地址可保持不变
- 交换机：H1 与哪个接入点（AP）关联？
  - 自学习功能：交换机将接收来自 H1 的帧，并 “记住” 可通过哪个交换机端口到达 H1

![](/Images/63fcc8f7-5db9-4dfb-b348-d399623f6eb8.png)

802.11：高级功能
速率自适应
❖ 基站和移动设备可随着移动设备的移动及信噪比（SNR）的变化，动态调整传输速率（物理层调制技术）

- QAM256（8 Mbps）
- QAM16（4 Mbps）
- BPSK（1 Mbps）

操作点与信噪比关系图：

| SNR（dB）     | 10   | 20   | 30   | 40   |      |      |      |                                                              |
| ------------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ------------------------------------------------------------ |
| 误码率（BER） | 10⁻¹ | 10⁻² | 10⁻³ | 10⁻⁴ | 10⁻⁵ | 10⁻⁶ | 10⁻⁷ | （注：图表横轴为 SNR，纵轴为 BER，曲线随 SNR 降低而 BER 升高） |

1. 当节点远离基站时，信噪比下降，误码率上升
2. 当误码率过高时，切换至更低的传输速率，以获得更低的误码率

![](/Images/e8c9e139-340a-4cd5-b8fd-99acfb1efd8f.png)

### 电源管理

❖ 节点向接入点（AP）发送：“我将进入休眠状态，直至下一信标帧到来”
▪ AP 知晓不向该节点传输帧
▪ 节点会在下一信标帧到来前唤醒
❖ 信标帧：包含待发送的 AP 到移动设备帧的移动设备列表
▪ 若存在待发送的 AP 到移动设备的帧，节点将保持唤醒状态；否则会再次休眠，直至下一信标帧到来

---

## 蜂窝网络

![](/Images/0d2d6658-eb39-4618-a001-5a30f31b855b.png)

### 蜂窝网络：第一跳

共享移动设备到基站无线频谱的两种技术
❖ 频分多址 / 时分多址结合（FDMA/TDMA）：
将频谱划分为多个频率信道，每个信道再划分为多个时隙
❖ 码分多址（CDMA）：
码分多址接入技术

![](/Images/5c830367-a331-4e8f-94da-0c241be7b705.png)

![](/Images/703ab0cf-91ad-4c73-843b-360300c23bef.png)

![](/Images/3abc7b2b-e1f9-4f36-a925-77a70b758531.png)

![](/Images/4f61e705-c377-4f15-b5fd-ad9d8be3a164.png)

---

![](/Images/fe2b49bb-dcdb-4485-b569-f85044a3e618.png)
